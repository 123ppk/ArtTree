<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Catalog â€” Admin / Client (Single File)</title>

  <!-- ========= Inline CSS ========= -->
  <style>
    :root{ --bg:#fff; --fg:#000; --muted:#777; --card:#f7f7f7; --glass: rgba(0,0,0,0.06)}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--glass);gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:44px;height:44px;border-radius:8px;background:linear-gradient(180deg,#000,#444);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
    h1{font-size:18px;margin:0}
    .top-actions{display:flex;gap:8px;align-items:center}
    button{background:transparent;border:0;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600}
    .btn-primary{background:#000;color:#fff}
    .btn-muted{color:var(--muted)}
    main{padding:18px;display:grid;grid-template-columns:260px 1fr;gap:18px}
    .sidebar{background:var(--card);padding:14px;border-radius:12px;min-height:140px}
    .panel-title{font-weight:700;margin-bottom:8px}
    .small{font-size:13px;color:var(--muted)}
    .toolbar{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
    .search{flex:1;display:flex;gap:8px}
    .search input{width:100%;padding:10px;border-radius:10px;border:1px solid var(--glass);background:transparent}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    .card{background:#fff;border-radius:12px;padding:10px;box-shadow:0 6px 14px rgba(0,0,0,0.04);display:flex;flex-direction:column;gap:10px}
    .media{height:160px;border-radius:10px;display:flex;align-items:center;justify-content:center;overflow:hidden;background:var(--card)}
    .media img{max-width:100%;max-height:100%;object-fit:contain;cursor:zoom-in;transition:transform .18s}
    .meta{display:flex;justify-content:space-between;align-items:center;gap:8px}
    .meta .title{font-weight:700}
    .meta .price{font-weight:800}
    .actions{display:flex;gap:8px;align-items:center}
    .qtybox{display:flex;align-items:center;gap:6px}
    .qtybox button{padding:6px 8px;border-radius:8px;background:var(--glass)}
    .muted{color:var(--muted);font-size:13px}
    .admin-controls{display:flex;flex-direction:column;gap:8px}
    input,select,textarea{padding:10px;border-radius:8px;border:1px solid var(--glass);background:transparent}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    .cart{position:fixed;right:18px;bottom:18px;background:#000;color:#fff;padding:10px 12px;border-radius:12px;display:flex;gap:10px;align-items:center}
    .cart-bubble{background:#fff;color:#000;padding:4px 8px;border-radius:999px;font-weight:700}
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;z-index:80}
    .modal{background:#fff;padding:16px;border-radius:12px;max-width:900px;width:96%;max-height:92vh;overflow:auto}
    .modal.show{display:block}
    .viewer{display:flex;flex-direction:column;align-items:center;gap:10px}
    .viewer img{max-width:100%;max-height:70vh;transform-origin:center center}
    .viewer .zoom-controls{display:flex;gap:8px}
    @media (max-width:900px){main{grid-template-columns:1fr;padding:12px} .sidebar{order:2} .grid{grid-template-columns:repeat(auto-fill,minmax(160px,1fr))}}
  </style>
</head>
<body>

<!-- ========= Header ========= -->
<header>
  <div class="brand">
    <div class="logo">BK</div>
    <div>
      <h1>Black & White Catalog</h1>
      <div class="small">Client: <span id="clientName">Guest</span></div>
    </div>
  </div>
  <div class="top-actions">
    <button id="loginBtn" class="btn-primary">Admin Login</button>
    <button id="addToCartBtn" class="btn-muted">Bag ðŸ§¾</button>
  </div>
</header>

<!-- ========= Main Section ========= -->
<main>
  <aside class="sidebar" id="sidebar">
    <div class="panel-title">Admin Panel</div>
    <div class="small">(Login to add / edit / publish products)</div>
    <div id="adminArea" style="display:none;margin-top:10px">
      <div class="admin-controls">
        <label>Brand / S.no</label><input id="pSerial" placeholder="S.no or SKU" />
        <label>Brand</label><input id="pBrand" placeholder="Brand" />
        <label>Model</label><input id="pModel" placeholder="Model / Name" />
        <label>Material Type</label><input id="pMaterial" placeholder="Material (eg. Cotton / Metal)" />
        <label>Retail Price</label><input id="pPrice" type="number" placeholder="Retail price" />
        <label>Application</label><input id="pApplication" placeholder="Use / Application" />
        <label>Image (choose)</label><input id="pImage" type="file" accept="image/*" />
        <div style="display:flex;gap:8px">
          <button id="saveProduct" class="btn-primary">Add / Publish</button>
          <button id="clearForm" class="btn-muted">Clear</button>
        </div>
      </div>
      <hr style="margin:12px 0;border:none;border-top:1px dashed var(--glass)" />
      <div>
        <div class="small">Admin actions</div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="exportBtn" class="btn-muted">Export JSON</button>
          <button id="importBtn" class="btn-muted">Import JSON</button>
          <button id="logoutBtn" class="btn-muted">Logout</button>
        </div>
      </div>
    </div>
    <div id="loginNotice" style="margin-top:12px">
      <div class="small">Not logged in. Click login to open admin credentials.</div>
    </div>
  </aside>

  <section>
    <div class="toolbar">
      <div class="search">
        <input id="searchInput" placeholder="Search by brand, model, material, application..." />
      </div>
      <div style="display:flex;gap:8px">
        <button id="showAll" class="btn-muted">Show All</button>
        <button id="publishedFilter" class="btn-muted">Published</button>
      </div>
    </div>

    <div class="grid" id="productGrid"></div>
  </section>
</main>

<!-- ========= Cart ========= -->
<div class="cart" id="cartBtn" title="Open cart" style="display:none">
  <div>Cart</div>
  <div class="cart-bubble" id="cartCount">0</div>
</div>

<!-- ========= Modals ========= -->
<div class="modal-backdrop" id="modalBackdrop">
  <div class="modal" role="dialog" aria-modal="true" id="modalContent"></div>
</div>

<!-- ========= JS Inline ========= -->
<script>
  // ========== Constants ==========
  const LS_KEY = 'bw_catalog_v1';
  const LS_CART = 'bw_cart_v1';
  const ADMIN_USER = {user:'admin', pass:'admin123'};

  // ========== DOM References ==========
  const loginBtn = document.getElementById('loginBtn');
  const adminArea = document.getElementById('adminArea');
  const loginNotice = document.getElementById('loginNotice');
  const saveProduct = document.getElementById('saveProduct');
  const clearForm = document.getElementById('clearForm');
  const logoutBtn = document.getElementById('logoutBtn');
  const pImage = document.getElementById('pImage');
  const productGrid = document.getElementById('productGrid');
  const modalBackdrop = document.getElementById('modalBackdrop');
  const modalContent = document.getElementById('modalContent');
  const cartBtn = document.getElementById('cartBtn');
  const cartCount = document.getElementById('cartCount');
  const addToCartBtn = document.getElementById('addToCartBtn');
  const clientNameEl = document.getElementById('clientName');
  const searchInput = document.getElementById('searchInput');
  const showAll = document.getElementById('showAll');
  const publishedFilter = document.getElementById('publishedFilter');

  // ========== App State ==========
  let products = JSON.parse(localStorage.getItem(LS_KEY)||'[]');
  let cart = JSON.parse(localStorage.getItem(LS_CART)||'{}');
  let isAdmin = sessionStorage.getItem('bw_admin')==='1';

  // ========== Helper Functions ==========
  function saveProducts(){ localStorage.setItem(LS_KEY, JSON.stringify(products)); }
  function saveCart(){ localStorage.setItem(LS_CART, JSON.stringify(cart)); }
  function uid(){ return Date.now().toString(36)+Math.random().toString(36).slice(2,7); }

  // ========== Render UI ==========
  function renderUI(){ 
    adminArea.style.display=isAdmin?'block':'none'; 
    loginNotice.style.display=isAdmin?'none':'block'; 
    loginBtn.innerText=isAdmin?'Admin':'Admin Login';
    clientNameEl.innerText=localStorage.getItem('bw_client_name')||'Guest';
    renderProducts();
    renderCartBubble();
  }

  function toast(msg){ const t=document.createElement('div'); t.textContent=msg; t.style.position='fixed'; t.style.right='18px'; t.style.bottom='88px'; t.style.background='#000'; t.style.color='#fff'; t.style.padding='8px 12px'; t.style.borderRadius='8px'; t.style.zIndex=999; document.body.appendChild(t); setTimeout(()=>t.remove(),2000); }

  // ========== Initial Demo Data ==========
  if(products.length===0){
    products.push({ id:uid(), serial:'001', brand:'Acme', model:'Classic', material:'Stainless', price:1299, application:'Home', image:'', published:true, created:Date.now() });
    saveProducts();
  }

  // ========== Render Products ==========
  function renderProducts(filter){
    const search = (searchInput.value||'').toLowerCase();
    productGrid.innerHTML='';
    products.filter(p=>{
      if(filter==='published' && !p.published) return false;
      if(search){
        const s=[p.brand,p.model,p.material,p.application].join(' ').toLowerCase();
        if(!s.includes(search)) return false;
      }
      return true;
    }).forEach(p=>{
      const card=document.createElement('div'); card.className='card';
      const media=document.createElement('div'); media.className='media';
      const img=document.createElement('img'); img.src=p.image||'https://via.placeholder.com/220x160?text=No+Image';
      img.addEventListener('click',()=>openViewer(p));
      media.appendChild(img);
      card.appendChild(media);

      const meta=document.createElement('div'); meta.className='meta';
      meta.innerHTML=`<div class="title">${p.brand} ${p.model}</div><div class="price">â‚¹${p.price}</div>`;
      card.appendChild(meta);

      const actions=document.createElement('div'); actions.className='actions';
      const qtybox=document.createElement('div'); qtybox.className='qtybox';
      const btnAdd=document.createElement('button'); btnAdd.innerText='Add'; btnAdd.onclick=()=>addToCart(p.id); qtybox.appendChild(btnAdd);
      actions.appendChild(qtybox);
      card.appendChild(actions);

      productGrid.appendChild(card);
    });
  }

  function renderCartBubble(){
    let total=0;
    for(let k in cart) total+=cart[k];
    cartCount.innerText=total; 
    cartBtn.style.display=total>0?'flex':'none';
  }

  // ========== Cart Actions ==========
  function addToCart(id){ cart[id]=(cart[id]||0)+1; saveCart(); renderCartBubble(); toast('Added to cart'); }

  // ========== Admin Actions ==========
  loginBtn.addEventListener('click',()=>{
    if(isAdmin){ toast('Already logged in'); return; }
    const u=prompt('Username',''); const p=prompt('Password','');
    if(u===ADMIN_USER.user && p===ADMIN_USER.pass){ isAdmin=true; sessionStorage.setItem('bw_admin','1'); renderUI(); toast('Admin logged in'); } else toast('Invalid'); 
  });

  logoutBtn.addEventListener('click',()=>{ isAdmin=false; sessionStorage.removeItem('bw_admin'); renderUI(); toast('Logged out'); });

  saveProduct.addEventListener('click',()=>{
    if(!isAdmin){ toast('Login first'); return; }
    const serial=document.getElementById('pSerial').value;
    const brand=document.getElementById('pBrand').value;
    const model=document.getElementById('pModel').value;
    const material=document.getElementById('pMaterial').value;
    const price=Number(document.getElementById('pPrice').value);
    const application=document.getElementById('pApplication').value;
    const file=pImage.files[0];
    if(!brand || !model){ toast('Brand & Model required'); return; }

    const reader = new FileReader();
    reader.onload = e => {
      products.push({id:uid(), serial, brand, model, material, price, application, image:e.target.result, published:true, created:Date.now()});
      saveProducts(); renderProducts(); toast('Product added');
    };
    if(file){ reader.readAsDataURL(file); } else { products.push({id:uid(), serial, brand, model, material, price, application, image:'', published:true, created:Date.now()}); saveProducts(); renderProducts(); toast('Product added'); }
  });

  clearForm.addEventListener('click',()=>{ document.getElementById('pSerial').value=''; document.getElementById('pBrand').value=''; document.getElementById('pModel').value=''; document.getElementById('pMaterial').value=''; document.getElementById('pPrice').value=''; document.getElementById('pApplication').value=''; pImage.value=''; });

  // ========== Product Viewer ==========
  function openViewer(p){
    modalBackdrop.style.display='flex';
    modalContent.innerHTML=`
      <div class="viewer">
        <img src="${p.image||'https://via.placeholder.com/400x300?text=No+Image'}" id="viewerImg">
        <div class="zoom-controls">
          <button onclick="zoomImg(1.2)">Zoom In</button>
          <button onclick="zoomImg(0.8)">Zoom Out</button>
          <button onclick="closeModal()">Close</button>
        </div>
      </div>
    `;
    let scale=1;
    window.zoomImg=function(f){ scale*=f; document.getElementById('viewerImg').style.transform='scale('+scale+')'; }
    window.closeModal=function(){ modalBackdrop.style.display='none'; }
  }

  // ========== Search & Filter ==========
  searchInput.addEventListener('input',()=>renderProducts());
  showAll.addEventListener('click',()=>renderProducts());
  publishedFilter.addEventListener('click',()=>renderProducts('published'));

  // ========== Initial Render ==========
  renderUI();
</script>

</body>
</html>
