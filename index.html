<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ArtTree - Your Link to Artfruit</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #fdf6f0;
      color: #333;
    }
    header {
      text-align: center;
      padding: 1em;
      background: #8e44ad;
      color: white;
      position: relative;
    }
    header h1 { margin: 0; font-size: 2em; }
    header p { margin: 0.2em 0; font-style: italic; }

    /* Container for header buttons */
    #headerButtons {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    #headerButtons button {
      background: #b47ed6;
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-family: inherit;
      font-size: 1em;
      transition: background-color 0.3s ease;
    }
    #headerButtons button:hover {
      background: #914bbd;
    }

    .container {
      max-width: 1000px;
      margin: auto;
      padding: 1em;
      text-align: center;
    }

    .login-section, .admin-panel {
      display: none;
    }

    input, button {
      margin: 0.5em 0;
      padding: 0.7em;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1em;
      font-family: inherit;
    }

    input { width: 100%; }

    button {
      background: #b47ed6;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
    }

    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin: 1em;
      padding: 1em;
      text-align: center;
      position: relative;
      flex: 1 1 45%;
      max-width: 48%;
    }

    .card-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }

    .card img {
      width: 140px;
      height: 140px;
      object-fit: cover;
      border-radius: 12px;
      transition: transform 0.3s ease;
      cursor: zoom-in;
      user-select: none;
    }

    /* Increased zoom scale for profile images */
    .card img.zoomed {
      transform: scale(3);
      z-index: 999;
      position: relative;
      cursor: zoom-out;
    }

    .card .art-images {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
	padding:25px;
    }

    .card .art-images img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      margin: 5px;
      transition: transform 0.3s ease;
      cursor: zoom-in;
      user-select: none;
    }

    /* Increased zoom scale for art images */
    .card .art-images img.zoomed {
      transform: scale(2.8);
      z-index: 999;
      position: relative;
      cursor: zoom-out;
    }

    .icons {
      margin-top: 1em;
    }

    .icons a {
      margin: 0 10px;
      color: #8e44ad;
      font-weight: bold;
      text-decoration: none;
    }

    .icons a:hover {
      text-decoration: underline;
    }

    .close-btn {
      position: absolute;
      top: 5px;
      right: 10px;
      cursor: pointer;
      font-size: 20px;
      color: red;
      user-select: none;
    }

    #payPopup {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
      z-index: 9999;
      display: flex;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #payPopup.show {
      visibility: visible;
      opacity: 1;
    }

    #payPopup .popup-inner {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      max-width: 300px;
    }

    .chip-container {
      padding: 10px;
      text-align: center;
    }

    .chip {
      display: inline-block;
      padding: 8px 14px;
      background: #8e44ad;
      color: white;
      border-radius: 20px;
      margin: 4px;
      cursor: pointer;
      font-size: 14px;
      user-select: none;
      transition: background-color 0.3s ease;
    }

    .chip:hover {
      background: #6c318b;
    }

    #searchInput {
      max-width: 300px;
      margin: 10px auto;
      display: none; /* Hidden initially */
      padding: 0.7em;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-family: inherit;
      font-size: 1em;
    }

    @media (max-width: 768px) {
      .card {
        max-width: 100%;
      }

      .card img,
      .card .art-images img {
        width: 100px;
        height: 100px;
      }
    }

    @media (max-width: 480px) {
      .card img,
      .card .art-images img {
        width: 90px;
        height: 90px;
      }
    }
  </style>
</head>
<body>






<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js"></script>




<script>
  // üîπ ‡§§‡•Å‡§ù‡§æ Firebase config ‡§á‡§•‡•á ‡§ü‡§æ‡§ï
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  // Firebase init
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // üîπ Firestore ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§ï‡§æ‡§∞‡•ç‡§° save ‡§ï‡§∞‡§£‡•á
  async function saveCardToFirestore(card) {
    await db.collection("artistCards").add(card);
    loadCardsFromFirestore();
  }

  // üîπ Firestore ‡§Æ‡§ß‡•Ç‡§® ‡§∏‡§∞‡•ç‡§µ ‡§ï‡§æ‡§∞‡•ç‡§° load ‡§ï‡§∞‡§£‡•á
  async function loadCardsFromFirestore() {
    const snapshot = await db.collection("artistCards").get();
    storedCards.length = 0;
    snapshot.forEach(doc => storedCards.push(doc.data()));
    showAllCards(userType === 'admin');
  }

  // üîπ Firestore ‡§Æ‡§ß‡•Ç‡§® ‡§ï‡§æ‡§∞‡•ç‡§° delete ‡§ï‡§∞‡§£‡•á
  async function deleteCardFromFirestore(index) {
    const snapshot = await db.collection("artistCards").get();
    const docs = snapshot.docs;
    if (docs[index]) {
      await db.collection("artistCards").doc(docs[index].id).delete();
      loadCardsFromFirestore();
    }
  }

  // ‚úÖ addCard override ‡§ï‡§∞‡•Ç‡§® Firestore ‡§µ‡§æ‡§™‡§∞‡§£‡§æ‡§∞
  const originalAddCard = addCard;
  addCard = function() {
    const name = document.getElementById('artistName').value;
    const category = document.getElementById('artistCategory').value.trim() || 'Uncategorized';
    const insta = document.getElementById('instaLink').value;
    const art = document.getElementById('artLink').value;
    const profileFile = document.getElementById('profilePic').files[0];
    const artFiles = document.getElementById('artImages').files;

    if (!name || !insta || !art || !profileFile || artFiles.length < 1) {
      return alert("Please fill all fields and add images");
    }

    resizeAndReadImage(profileFile, (profileData) => {
      let artDataList = [];
      let loaded = 0;
      for (let i = 0; i < artFiles.length && i < 10; i++) {
        resizeAndReadImage(artFiles[i], (imgData) => {
          artDataList.push(imgData);
          loaded++;
          if (loaded === Math.min(artFiles.length, 10)) {
            const createdDate = new Date().toISOString();
            const card = { name, category, insta, art, profile: profileData, arts: artDataList, created: createdDate };
            saveCardToFirestore(card); // Firestore ‡§Æ‡§ß‡•ç‡§Ø‡•á save
          }
        });
      }
    });
  }

  // ‚úÖ deleteCard override
  const originalDeleteCard = deleteCard;
  deleteCard = function(index) {
    if (confirm("Delete this artist card?")) {
      deleteCardFromFirestore(index);
    }
  }

  // Page load ‡§ù‡§æ‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ Firestore ‡§Æ‡§ß‡•Ç‡§® data load
  window.onload = () => {
    loginHeaderBtn.style.display = 'inline-block';
    logoutBtn.style.display = 'none';
    loadCardsFromFirestore();
  };
</script>











































<header>
  <h1>ArtTree</h1>
  <p>Your link to the artfruit üçá</p>
  <div id="headerButtons">
    <button id="loginHeaderBtn" onclick="showLoginPopup()">Login</button>
    <button id="logoutBtn" style="display:none;" onclick="logout()">Logout</button>
  </div>
</header>

<div class="container">

  <div class="login-section" id="loginSection" style="display:none;">
    <h2>Login</h2>
    <input type="email" id="email" placeholder="Enter email" autocomplete="username"/>
    <input type="password" id="password" placeholder="Enter password" autocomplete="current-password" />
    <button onclick="login()">Login</button>
  </div>

  <div class="admin-panel" id="adminPanel">
    <h2>Add Artist Card</h2>
    <input type="text" id="artistName" placeholder="Artist Name" />
    <input type="text" id="artistCategory" placeholder="Enter Category" />
    <input type="text" id="instaLink" placeholder="Instagram Link" />
    <input type="text" id="artLink" placeholder="Portfolio/Art Link" />
    <input type="file" id="profilePic" accept="image/*" />
    <label>Upload up to 10 Art Images</label>
    <input type="file" id="artImages" accept="image/*" multiple />
    <button onclick="addCard()">Add Artist Card</button>
    <hr>
  </div>

  <div class="card-container" id="cardList"></div>
</div>

<div id="payPopup">
  <div class="popup-inner">
    <h3>Card Expired</h3>
    <p>This card has expired. Please renew to unlock more features.</p>
    <img src="https://chart.googleapis.com/chart?cht=qr&chs=200x200&chl=upi://pay?pa=youremail@upi&pn=ArtTree&am=99&cu=INR" alt="GPay QR" />
    <br><br>
    <button onclick="hidePayPopup()">Close</button>
  </div>
</div>

<script>
  const loginSection = document.getElementById('loginSection');
  const adminPanel = document.getElementById('adminPanel');
  const logoutBtn = document.getElementById('logoutBtn');
  const loginHeaderBtn = document.getElementById('loginHeaderBtn');
  const cardList = document.getElementById('cardList');
  const payPopup = document.getElementById('payPopup');
  const adminEmail = 'admin@arttree.com';

  const storedCards = JSON.parse(localStorage.getItem('artistCards') || '[]');
  let userType = '';

  function showLoginPopup(){
    loginSection.style.display = 'block';
    adminPanel.style.display = 'none';
    loginSection.style.position = 'fixed';
    loginSection.style.top = '50%';
    loginSection.style.left = '50%';
    loginSection.style.transform = 'translate(-50%, -50%)';
    loginSection.style.background = '#fff';
    loginSection.style.padding = '20px';
    loginSection.style.borderRadius = '12px';
    loginSection.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
    loginSection.style.zIndex = '10000';
  }

  function hideLoginPopup(){
    loginSection.style.display = 'none';
    loginSection.style.position = '';
    loginSection.style.top = '';
    loginSection.style.left = '';
    loginSection.style.transform = '';
    loginSection.style.background = '';
    loginSection.style.padding = '';
    loginSection.style.borderRadius = '';
    loginSection.style.boxShadow = '';
    loginSection.style.zIndex = '';
  }

  function logout() {
    userType = '';
    hideLoginPopup();
    adminPanel.style.display = 'none';
    logoutBtn.style.display = 'none';
    loginHeaderBtn.style.display = 'inline-block';
    showAllCards();
  }

  function login() {
    const email = document.getElementById('email').value.trim().toLowerCase();
    const password = document.getElementById('password').value.trim();
    if (!email || !password) return alert("Fill all fields");

    if (email === adminEmail) {
      userType = 'admin';
      hideLoginPopup();
      adminPanel.style.display = 'block';
      logoutBtn.style.display = 'inline-block';
      loginHeaderBtn.style.display = 'none';
      showAllCards(true);
    } else {
      alert("Wrong email or password");
    }
  }

  function resizeAndReadImage(file, callback) {
    const reader = new FileReader();
    reader.onload = function (e) {
      const img = new Image();
      img.onload = function () {
        const canvas = document.createElement("canvas");
        const scale = 300 / Math.max(img.width, img.height);
        canvas.width = img.width * scale;
        canvas.height = img.height * scale;
        canvas.getContext("2d").drawImage(img, 0, 0, canvas.width, canvas.height);
        callback(canvas.toDataURL("image/jpeg", 0.7));
      };
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
  }

  function addCard() {
    const name = document.getElementById('artistName').value;
    const category = document.getElementById('artistCategory').value.trim() || 'Uncategorized';
    const insta = document.getElementById('instaLink').value;
    const art = document.getElementById('artLink').value;
    const profileFile = document.getElementById('profilePic').files[0];
    const artFiles = document.getElementById('artImages').files;

    if (!name || !insta || !art || !profileFile || artFiles.length < 1) {
      return alert("Please fill all fields and add images");
    }

    resizeAndReadImage(profileFile, (profileData) => {
      let artDataList = [];
      let loaded = 0;
      for (let i = 0; i < artFiles.length && i < 10; i++) {
        resizeAndReadImage(artFiles[i], (imgData) => {
          artDataList.push(imgData);
          loaded++;
          if (loaded === Math.min(artFiles.length, 10)) {
            const createdDate = new Date().toISOString();
            const card = { name, category, insta, art, profile: profileData, arts: artDataList, created: createdDate };
            storedCards.push(card);
            localStorage.setItem('artistCards', JSON.stringify(storedCards));
            showAllCards(true);
          }
        });
      }
    });
  }

  // showAdmin param: true means admin logged in (show delete buttons & add form), false = public view
  function showAllCards(showAdmin = false) {
    cardList.innerHTML = '';
    storedCards.forEach((card, index) => {
      const createdDate = new Date(card.created);
      const expiryDate = new Date(createdDate);
      expiryDate.setMonth(createdDate.getMonth() + 3);
      const expired = new Date() > expiryDate;

      const div = document.createElement('div');
      div.className = 'card';
      div.setAttribute("data-category", card.category || 'Uncategorized');

      div.innerHTML = `
        ${showAdmin ? `<span class="close-btn" onclick="deleteCard(${index})" title="Delete this artist card">√ó</span>` : ''}
        <img src="${card.profile}" onclick="toggleZoom(this)" alt="Profile Image"/>
        <h3>${card.name}</h3>
        <div>${createdDate.toDateString()} - ${expiryDate.toDateString()}</div>
        <div class="icons">
          <a href="${card.insta}" target="_blank" rel="noopener noreferrer">Instagram</a>
          <a href="${card.art}" target="_blank" rel="noopener noreferrer">Art Link</a>
        </div>
        <div class="art-images">
          ${card.arts.map(a => `<img src="${a}" onclick="toggleZoom(this)" alt="Art Image" />`).join('')}
        </div>
        ${expired && !showAdmin ? '<button onclick="showPayPopup()">Pay Now</button>' : ''}
      `;
      cardList.appendChild(div);
    });

    // Show/hide admin panel and buttons accordingly
    adminPanel.style.display = showAdmin ? 'block' : 'none';
  }

  function toggleZoom(img) {
    document.querySelectorAll('.zoomed').forEach(el => {
      if (el !== img) el.classList.remove('zoomed');
    });
    img.classList.toggle('zoomed');
  }

  function deleteCard(index) {
    if (confirm("Delete this artist card?")) {
      storedCards.splice(index, 1);
      localStorage.setItem('artistCards', JSON.stringify(storedCards));
      showAllCards(true);
    }
  }

  function showPayPopup() {
    payPopup.classList.add('show');
  }

  function hidePayPopup() {
    payPopup.classList.remove('show');
  }

  // On page load, show public cards and login button
  window.onload = () => {
    loginHeaderBtn.style.display = 'inline-block';
    logoutBtn.style.display = 'none';
    showAllCards(false);
  };






</script>

</body>
</html>
